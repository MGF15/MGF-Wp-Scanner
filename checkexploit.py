import sys, urllib2, re, os , colorama , urllib

from colorama import Fore, Back, Style , init

colorama.init()

host = raw_input("Site:")

	
Dir = os.path.dirname(os.path.realpath(__file__)) + os.path.sep
dogo=open(Dir +'ch.txt','r')
for exploit in dogo.read().split('\n'):
	try:
		resp = (host + '/wp-content/plugins/' + exploit + '/readme.txt')
		F	 =	urllib2.urlopen(resp)
		B=F.read()
		v=re.findall(r'(Stable tag: \w+.\w+)',B)
		n=re.findall(r'(Stable tag: \w+.\w+.\w+)',B)
		if n:
			print (Fore.GREEN + "\n\t"), exploit , "===>",n[0]
		elif v:
			print (Fore.GREEN + "\n\t"), exploit , "===>",v[0]
	
		search='http://exploitsearch.net/index.php?q='
		
		rest=(search+exploit)
		page=urllib2.urlopen(rest)
		page = page.read()
		links = re.findall(r'"((http)://www.*?/exploits/.*?)"', page)
		for link in links:
			print(Fore.YELLOW +'\t[+] Check: %s' % (link[0]))
	except:
		pass
